var BespinArea={}; BespinArea.Layouts=function(){jQuery("#layout_content").hide();jQuery("#layout_content").after('<div id="bespin_editor"></div>');jQuery("#bespin_editor").css({"margin-top":"5px","margin-bottom":"5px",height:"300px"});BespinArea.Editor=new bespin.editor.Component("bespin_editor",{language:"html",loadfromdiv:true,set:{strictlines:"on"}});BespinArea.Editor.setContent(jQuery("#layout_content").val());jQuery("#content form").submit(function(){jQuery("#layout_content").val(BespinArea.Editor.getContent())});jQuery(window).bind("keydown", "Alt+return",function(){BespinArea.FullScreen(jQuery("#bespin_editor"))});jQuery(window).bind("keydown","Alt+c",function(){BespinArea.Editor.setContent(jQuery.htmlClean(BespinArea.Editor.getContent(),{format:true,bodyOnly:false}))})}; BespinArea.Assets=function(){jQuery("#asset_content").hide();jQuery("#asset_content").after('<div id="bespin_editor"></div>');jQuery("#bespin_editor").css({"margin-top":"5px","margin-bottom":"5px",height:"300px"});if(jQuery("#assetjs").size()>0)var a="js";if(jQuery("#assetcss").size()>0)a="css";BespinArea.Editor=new bespin.editor.Component("bespin_editor",{language:a,loadfromdiv:true,set:{strictlines:"on"}});BespinArea.Editor.setContent(jQuery("#asset_content").val());jQuery("#content form").submit(function(){jQuery("#asset_content").val(BespinArea.Editor.getContent())}); jQuery(window).bind("keydown","Alt+return",function(){BespinArea.FullScreen(jQuery("#bespin_editor"))});jQuery(window).bind("keydown","Alt+c",function(){BespinArea.Editor.setContent(jQuery.htmlClean(BespinArea.Editor.getContent(),{format:true,bodyOnly:false}))})}; BespinArea.Snippet=function(){jQuery("#snippet_filter_id").change(BespinArea.Snippet);if(jQuery("#snippet_filter_id").val()=="bespin_area"){jQuery("#snippet_content").hide();jQuery("#snippet_content").after('<div id="bespin_editor"></div>');jQuery("#bespin_editor").css({"margin-top":"5px","margin-bottom":"5px",height:"300px"});BespinArea.Editor=new bespin.editor.Component("bespin_editor",{language:"php",loadfromdiv:true,set:{strictlines:"on"}});BespinArea.Editor.setContent(jQuery("#snippet_content").val()); jQuery("#content form").submit(function(){jQuery("#snippet_content").val(BespinArea.Editor.getContent())});jQuery(window).bind("keydown","Alt+return",function(){BespinArea.FullScreen(jQuery("#bespin_editor"))});jQuery(window).bind("keydown","Alt+c",function(){BespinArea.Editor.setContent(jQuery.htmlClean(BespinArea.Editor.getContent(),{format:true,bodyOnly:false}))})}else if(jQuery("#bespin_editor").size()>0){jQuery("#snippet_content").val(BespinArea.Editor.getContent());jQuery("#snippet_filter_id").val()!= "tinymce"&&jQuery("#snippet_content").show();jQuery("#bespin_editor").remove()}}; BespinArea.Pages=function(){jQuery("select[id$='filter_id']").change(BespinArea.Pages);jQuery("#tabs a.tab").click(BespinArea.Pages);var a=jQuery("div.page:visible").attr("id");if(jQuery("#"+a+" select").val()=="bespin_area"){if(jQuery("#bespin_editor_"+a).size()==0){jQuery("#"+a+" textarea").hide();jQuery("#"+a+" textarea").after('<div id="bespin_editor_'+a+'"></div>');jQuery("#bespin_editor_"+a).css({"margin-top":"5px","margin-bottom":"5px",height:"300px"});var b;jQuery("select[id$='page_behavior_id'] option:selected").each(function(){switch(jQuery(this).attr("value")){case "Css":b= "css";break;case "Javascript":b="js";break;default:b="html"}});BespinArea.Editor[a]=new bespin.editor.Component("bespin_editor_"+a,{language:b,loadfromdiv:true,set:{strictlines:"on"}});BespinArea.Editor[a].setContent(jQuery("#"+a+" textarea").val());jQuery("#content form").submit(function(){jQuery("#"+a+" textarea").val(BespinArea.Editor[a].getContent())})}}else if(jQuery("#bespin_editor_"+a).size()>0){jQuery("#"+a+" textarea").val(BespinArea.Editor[a].getContent());jQuery("#"+a+" select").val()!= "tinymce"&&jQuery("#"+a+" textarea").show();jQuery("#bespin_editor_"+a).remove()}if(BespinArea.FullScreenBound==false){BespinArea.FullScreenBound=true;jQuery(window).bind("keydown","Alt+return",function(){BespinArea.FullScreen(jQuery("#bespin_editor_"+jQuery("div.page:visible").attr("id")))});jQuery(window).bind("keydown","Alt+c",function(){BespinArea.Editor[jQuery("div.page:visible").attr("id")].setContent(jQuery.htmlClean(BespinArea.Editor[jQuery("div.page:visible").attr("id")].getContent(),{format:true, bodyOnly:false}))})}};BespinArea.FullScreen=function(a){if(BespinArea.FullScreenMode==false){jQuery("body").css("overflow","hidden");a.css({height:jQuery(window).height(),width:jQuery(window).width(),position:"absolute",top:"0px",left:"0px",margin:"0px","z-index":"9999"});BespinArea.FullScreenMode=true}else{a.removeAttr("style");a.css({"margin-top":"5px","margin-bottom":"5px",height:"300px"});jQuery("body").css("overflow","auto");BespinArea.FullScreenMode=false}};BespinArea.FullScreenBound=false; BespinArea.FullScreenMode=false;jQuery(document).ready(function(){jQuery("#layout_content").size()>0&&BespinArea.Layouts();jQuery("#asset_content").size()>0&&BespinArea.Assets();jQuery("#snippet_content").size()>0&&BespinArea.Snippet();if(jQuery("#part_0_content").size()>0){BespinArea.Editor={};BespinArea.Pages()}});